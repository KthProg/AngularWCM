<!DOCTYPE HTML>
<html>
<head>
    <title>SEWO</title>

    
     <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.13/angular.min.js"></script>
    <script src="/scripts/js/wcm.js"></script>
    <script src="/scripts/js/form.js"></script>
    <script src="/scripts/js/table.js"></script>
    <script src="/scripts/js/record.js"></script>
    <script src="/scripts/js/sketch.js"></script>
    <script src="/scripts/js/field.js"></script>
    <script src="/scripts/js/format.js"></script>

    <link rel="stylesheet" href="css/Normalize.css" />
    <link rel="stylesheet" href="css/FormClasses.css" />

    <title>SEWO</title>
</head>
<body ng-app="wcm" 
    ng-controller="Form" 
    ng-init="initialize('SEWO', 'WCM', ['ESEWOs'])">
    <table style="width: 100%;">
        <tr>
            <td colspan="5" class="dkgrey whitetext">
                <h1>SEWO Report</h1>
            </td>
            <td colspan="3" class="ltgrey">
                <style>
                    [field*='[\'SEWONumber\']'] input {
                        background-color: inherit;
                        border: none;
                    }
                </style>
                <h2>SEWO Number<field field="fields['SEWONumber']"></field></h2>
            </td>
        </tr>
        <tr>
            <td rowspan="33" class="vert-text green whitetext">
                P<br>
                L<br>
                A<br>
                N
            </td>
            <td class="ltgrey">Sex</td>
            <td colspan="2">
                <field field="fields['Sex']" options="['Male', 'Female']"></field>
            </td>
            <td class="ltgrey">Accident Type</td>
            <td class="ltgrey">Position Type</td>
            <td class="ltgrey">PPE Supplied</td>
            <td class="ltgrey">PPE in Use</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['InjuredName']"></field>
            </td>
            <td>
                <field field="fields['AccidentTypeID']" required="true"></field>
            </td>
            <td>
                <field field="fields['TypeOfPosition']" options="['Permanent','Temporary']"></field>
            </td>
            <td>
                <field field="fields['PPESupplied']" options='["Yes","No"]'></field>
            </td>
            <td>
                <field field="fields['PPEInUse']" options='["Yes","No"]'></field>
            </td>
        </tr>
        <tr class="ltgrey">
            <td colspan="3">Injured Job</td>
            <td>Reported By</td>
            <td>Shift</td>
            <td>Injury Date</td>
            <td>Injury Time</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['InjuredJob']"></field>
            </td>
            <td>
                <field field="fields['ReportedBy']"></field>
            </td>
            <td>
                <field field="fields['Shift']" options="[1,2,3]"></field>
            </td>
            <td>
                <field field="fields['InjuryDate']" required="true"></field>
            </td>
            <td>
                <field field="fields['InjuryTime']"></field>
            </td>
        </tr>
        <tr class="ltgrey">
            <td colspan="2">Injury Type</td>
            <td>Usual Work</td>
            <td>Work Plant</td>
            <td>Work Department</td>
            <td>Work Zone</td>
            <td>Work Machine</td>
        </tr>
        <tr>
            <td colspan="2">
                <field field="fields['InjuryTypeID']" required="true"></field>
            </td>
            <td>
                <field field="fields['UsualWork']" options='["Yes","No"]'></field>
            </td>
            <td>
                <field field="fields['PlantID']" required="true"></field>
            </td>
            <td>
                <field field="fields['DepartmentID']" required="true"></field>
            </td>
            <td>
                <field field="fields['ZoneID']" required="true"></field>
            </td>
            <td>
                <field field="fields['MachineID']"></field>
            </td>
        </tr>
        <tr class="ltgrey">
            <td colspan="2">Injury Plant</td>
            <td colspan="2">Injury Department</td>
            <td colspan="2">Injury Zone</td>
            <td>Injury Machine</td>
        </tr>
        <tr>
            <td colspan="2">
                <field field="fields['InjuryPlantID']" required="true"></field>
            </td>
            <td colspan="2">
                <field field="fields['InjuryDepartmentID']" required="true"></field>
            </td>
            <td colspan="2">
                <field field="fields['InjuryZoneID']" required="true"></field>
            </td>
            <td>
                <field field="fields['InjuryMachineID']"></field>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">5W + 1H Analysis</td>
            <td colspan="2" rowspan="2" class="dkgreen whitetext">BODY CHART</td>
            <td class="dkgreen whitetext" rowspan="2">SKETCH</td>
            <td class="dkgreen whitetext" rowspan="2">CORRECTIVE ACTION</td>
        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">What</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['WWhat']" multiline="true"></field>
            </td>
            <td colspan="2" rowspan="11">
                <style>
                    [field*="BodyPartID"] select {
                        height: 20%;
                        /*change to select when done*/
                    }
                </style>
                <img src="https://192.9.200.62/res/BodyChart.png" style="width: 200px; height: 200px;" />
                <field field="fields['BodyPartID']"></field>
            </td>
            <td rowspan="11">
                <sketch field="fields['SketchURL']"></sketch>
            </td>
            <td rowspan="11">
                <field field="fields['ActionDescription']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">When</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['WWhen']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">Where</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['WWhere']" multiline="true"></field>
            </td>

        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">Who</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['WWho']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">Which</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['WWhich']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="dkgreen whitetext">How</td>
        </tr>
        <tr>
            <td colspan="3">
                <field field="fields['HHow']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext" colspan="8">Analysis Root Cause: Write "5 Why's" for the most probable cause</td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">1</td>
            <td colspan="7">
                <field field="fields['FiveWhy1']"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">..2</td>
            <td colspan="7">
                <field field="fields['FiveWhy2']"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">....3</td>
            <td colspan="7">
                <field field="fields['FiveWhy3']"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">......4</td>
            <td colspan="7">
                <field field="fields['FiveWhy4']"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">........5</td>
            <td colspan="7">
                <field field="fields['FiveWhy5']"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">Root Cause</td>
            <td colspan="7">
                <field field="fields['FiveWhyRootCause']"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext" colspan="8">Categorize Root Cause</td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">Root Cause Type</td>
            <td colspan="7">
                <field field="fields['RootCauseID']" required="true"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">2nd Root Cause</td>
            <td colspan="7">
                <field field="fields['SecondaryCauseID']" required="true"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">Micro Root Cause</td>
            <td colspan="7">
                <field field="fields['MicroCauseID']" required="true"></field>
            </td>
        </tr>
        <tr>
            <td class="ltgreen whitetext">Action</td>
            <td colspan="7">
                <field field="fields['ActionID']"></field>
            </td>
        </tr>
        <tr>
            <td rowspan="2" class="vert-text blue whitetext">
                D<br>
                O
            </td>
            <td colspan="3" class="dkblue whitetext">Action Plan</td>
            <td class="dkblue whitetext">RESPONSIBLE</td>
            <td class="dkblue whitetext">DUE DATE</td>
            <td class="dkblue whitetext">CLOSE DATE</td>
            <td class="dkblue whitetext">NOTES</td>
        </tr>
        <tr>
            <td colspan="3" height="100px">
                <field field="fields['ActionPlan']" multiline="true"></field>
            </td>
            <td>
                <field field="fields['Responsible']" multiline="true"></field>
            </td>
            <td>
                <field field="fields['DueDate']" multiline="true"></field>
            </td>
            <td>
                <field field="fields['CloseDate']" multiline="true"></field>
            </td>
            <td>
                <field field="fields['Notes']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td colspan="8">
                <table style="width: 100%;">
                    <tr>
                        <td rowspan="9" class="vert-text dkred whitetext">
                            C<br>
                            H<br>
                            E<br>
                            C<br>
                            K
                        </td>
                        <td colspan="3" height="150">
                            RESULTS ACHEIVED WEEKLY
                            <!-- an embedded excel chart maybe, or move to dashboard -->
                        </td>
                        <td class="vert-text yellow">
                            A<br>
                            C<br>
                            T
                        </td>
                        <td valign="top">
                            <table style="width: 100%; height: 150px;">
                                <tr>
                                    <td>
                                        <field field="fields['ExpansionPlan']" options='["Yes","No"]'></field>
                                    </td>
                                    <td>
                                        <field field="fields['Location']" multiline="true"></field>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <field field="fields['Act']" multiline="true"></field>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="8">
                <table style="width: 100%;">
                    <tr class="ltgrey">
                        <td></td>
                        <td>Employee</td>
                        <td>Team Leader</td>
                        <td>Supervisor</td>
                        <td>Mgr Depart.</td>
                        <td>Safety Mgr.</td>
                        <td>Plant Mgr.</td>
                    </tr>
                    <tr>
                        <td class="ltgrey">Name</td>
                        <td>
                            <field field="fields['EmployeeName']"></field>
                        </td>
                        <td>
                            <field field="fields['TeamLeadName']"></field>
                        </td>
                        <td>
                            <field field="fields['SupervisorName']"></field>
                        </td>
                        <td>
                            <field field="fields['DeptManagerName']"></field>
                        </td>
                        <td>
                            <field field="fields['SafetyMgrName']"></field>
                        </td>
                        <td>
                            <field field="fields['PlantMgrName']"></field>
                        </td>
                    </tr>
                    <tr>
                        <td class="ltgrey">Date</td>
                        <td>
                            <field field="fields['EmployeeDate']"></field>
                        </td>
                        <td>
                            <field field="fields['TeamLeadDate']"></field>
                        </td>
                        <td>
                            <field field="fields['SupervisorDate']"></field>
                        </td>
                        <td>
                            <field field="fields['DeptManagerDate']"></field>
                        </td>
                        <td>
                            <field field="fields['SafetyMgrDate']"></field>
                        </td>
                        <td>
                            <field field="fields['PlantMgrDate']"></field>
                        </td>
                    </tr>
                    <tr>
                        <td class="ltgrey">Signature</td>
                        <td>
                            <field field="fields['EmployeeSignature']"></field>
                        </td>
                        <td>
                            <field field="fields['TeamLeadSignature']"></field>
                        </td>
                        <td>
                            <field field="fields['SupervisorSignature']"></field>
                        </td>
                        <td>
                            <field field="fields['DeptManagerSignature']"></field>
                        </td>
                        <td>
                            <field field="fields['SafetyMgrSignature']"></field>
                        </td>
                        <td>
                            <field field="fields['PlantMgrSignature']"></field>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr class="ltgrey">
            <td colspan="6">
                <h3>Injured Statement</h3>
            </td>
            <td colspan="3">
                <h3>Witness Statement</h3>
            </td>
        </tr>
        <tr style="height: 200px;">
            <td colspan="6">
                <field field="fields['InjuredStatement']" multiline="true"></field>
            </td>
            <td colspan="2">
                <field field="fields['WitnessStatement']" multiline="true"></field>
            </td>
        </tr>
        <tr>
            <td colspan="4">
                <field field="fields['InjuredSignature']"></field>
            </td>
            <td colspan="2">
                <field field="fields['InjuredDate']"></field>
            </td>
            <td>
                <field field="fields['WitnessSignature']"></field>
            </td>
            <td>
                <field field="fields['WitnessDate']"></field>
            </td>
        </tr>
        <tr>
            <td colspan="8">
                <button ng-click="form.reset()">Reset</button>
                <button ng-click="form.executeQueries()">{{form.hasRecord ? "Update" : "Submit"}}</button>
            </td>
        </tr>
    </table>
</body>
</html>
