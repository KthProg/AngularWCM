var app=angular.module("wcm",[]);function changeImage(input,imgEl){var isBlank=(input.val()=="");imgEl.attr("src",(isBlank?"res/upload.png":"res/uploadgreen.png"))}function imgToBase64(imgEl,line){var fileReader=new FileReader();fileReader.onload=function(e){args={name:name,line:line,URI:e.target.result};angular.element("[ng-app='wcm']").injector().get('$rootScope').$broadcast('uploadImage',args)}var name=imgEl.files[0].fileName||imgEl.files[0].name;var line=line;fileReader.readAsDataURL(imgEl.files[0])}function drawSketch(){var sketchArea=$("canvas");var sketchCtx=sketchArea[0].getContext("2d");var off=sketchArea.offset();var relX=(mouse.x-off.left);var relY=(mouse.y-off.top);sketchCtx.fillStyle=$("#colorPicker").val();if(mouse.left){sketchCtx.fillRect(relX,relY,$("#brushSize").val(),$("#brushSize").val())}}function clearSketch(){var sketchArea=$("canvas");var sketchCtx=sketchArea[0].getContext("2d");sketchCtx.clearRect(0,0,sketchArea.width(),sketchArea.height())}var mouse={x:0,y:0,left:false};document.addEventListener('mousemove',function(e){mouse.x=e.pageX||e.clientX;mouse.y=e.pageY||e.clientY},false);document.addEventListener('mousedown',function(e){mouse.left=(e.button===0)},false);document.addEventListener('mouseup',function(e){mouse.left=false},false);function alterHTMLForEmail(){var currentHTML="<html>\r\n\t<head>\r\n\t\t<style>\r\n";currentHTML+=getAllCSS();currentHTML+="\t\t</style>\r\n\t</head>\r\n\t<body>\r\n";currentHTML+=$(document.body).html();$("input, select, textarea").each(function(){var model="",tag="";if((model=$(this).attr("ng-model"))&&(tag=$(this).prop("tagName"))){var thisRegex="<"+tag+".*"+model.replace("]","\\]").replace("[","\\[")+".*(/>|>|</"+tag+">)";currentHTML=currentHTML.replace(new RegExp(thisRegex,"i"),"<textarea>"+getInputValue($(this))+"</textarea>")}});currentHTML+="\t</body>\r\n</html>";return currentHTML}function getInputValue(jqEl){switch(jqEl.prop("tagName")){case"SELECT":return jqEl.children("option:selected").text();break;case"INPUT":case"TEXTAREA":return jqEl.val()break}}function getAllCSS(){var allCSS="";for(var i=0,l=document.styleSheets.length;i<l;++i){if(document.styleSheets[i].cssRules){for(var j=0,l2=document.styleSheets[i].cssRules.length;j<l2;++j){allCSS+=document.styleSheets[i].cssRules[j].cssText}}}return allCSS}function objectValuesToArray(obj){return $.map(obj,function(value,index){return[value]})}