<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.18/angular.js"></script>
    <!-- <script src="/scripts/js/wcm.js"></script>
    <script src="/scripts/js/form.js"></script> -->
    <script src="/scripts/js/wcm.js"></script>
    <script src="/scripts/js/form.js"></script>

    <link rel="stylesheet" href="css/Normalize.css" />
    <link rel="stylesheet" href="css/FormClasses.css" />
    <style>
        h3 {
            padding: 0px;
            margin: 0px;
            font-size: 1em;
            font-weight: normal;
        }
    </style>
    <title>JSA</title>
</head>

<body ng-app="wcm"
      ng-controller="Form"
      ng-init="setFormData('JSA'); rpArr = [''];">
    <table>
        <tr>
            <td style="width: 24%;"></td>
            <td style="width: 24%;"></td>
            <td style="width: 24%;"></td>
            <td style="width: 24%;"></td>
            <td style="width: 4%;"></td>
        </tr>
        <tr>
            <td colspan="3" class="dkgrey whitetext"><h1>Job / Task Safety Analysis</h1></td>
            <td class="ltgrey"><h2>JSA Number {{id + (hasRecord ? " (Updating)" : " (New Form)")}}</h2></td>
        </tr>
        <tr class="ltgrey">
            <td>Plant</td>
            <td>Department</td>
            <td>Zone</td>
            <td>Machine</td>
        </tr>
        <tr>
            <td><select ng-model="fields['PlantID']" ng-options="k as v for (k,v) in queries['PlantID'].options" required></select></td>
            <td><select ng-model="fields['DepartmentID']" ng-options="k as v for (k,v) in queries['DepartmentID'].options" required></select></td>
            <td><select ng-model="fields['ZoneID']" ng-options="k as v for (k,v) in queries['ZoneID'].options" required></select></td>
            <td><select ng-model="fields['MachineID']" ng-options="k as v for (k,v) in queries['MachineID'].options" required></select></td>
        </tr>
        <tr class="ltgrey">
            <td colspan="2">Risk</td>
            <td colspan="2">Probability</td>
        </tr>
        <tr ng-repeat="i in rpArr track by $index">
            <td colspan="2">
                <select ng-model="fields['Risk' + ($index + 1)]">
                    <option value="0">None</option>
                    <option value="1">Low</option>
                    <option value="2">Medium</option>
                    <option value="3">High</option>
                </select>
            </td>
            <td colspan="2">
                <select ng-model="fields['Prob' + ($index + 1)]">
                    <option value="0">None</option>
                    <option value="1">Low</option>
                    <option value="2">Medium</option>
                    <option value="3">High</option>
                </select>
            </td>
            <td ng-show ="(rpArr.length - 1) == $index">
                <button ng-click="rpArr.push('')">+ Add</button>
            </td>
        </tr>
        <tr>
            <td colspan="4">
                <button ng-click="open()">Open</button>
                <button ng-click="clear()">Clear</button>
                <button ng-click="submit()" ng-show="!hasRecord">Submit</button>
                <button ng-click="update()" ng-show="hasRecord">Update</button>
            </td>
        </tr>
    </table>
</body>
</html>