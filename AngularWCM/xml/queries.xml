<?xml version="1.0" encoding="utf-8" ?>
<queries>
  <query name="Plants">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT PlantID, Plant FROM PlantLayout</qstring>
  </query>
  <query name="Departments">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT DepartmentID, Department FROM PlantLayout WHERE PlantID=?</qstring>
  </query>
  <query name="Zones">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ZoneID, Zone FROM PlantLayout WHERE PlantID=? AND DepartmentID=?</qstring>
  </query>
  <query name="WorkCells">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT WorkCellID, WorkCell FROM PlantLayout WHERE PlantID=? AND DepartmentID=? AND ZoneID=?</qstring>
  </query>
  <query name="Machines">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT MachineID, Machine FROM PlantLayout WHERE PlantID=? AND DepartmentID=? AND ZoneID=?</qstring>
  </query>
  <query name="Subsystems">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT PartID, Part FROM PlantLayout WHERE PlantID=? AND DepartmentID=? AND ZoneID=? AND MachineID=?</qstring>
  </query>
  <query name="Auditors">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, AuditorName FROM Auditor WHERE AuditorType=?</qstring>
  </query>
  <query name="Supervisors">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, SupervisorName FROM Supervisor</qstring>
  </query>
  <query name="AccidentTypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, AccidentType FROM AccidentTypes</qstring>
  </query>
  <query name="InjuryTypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, InjuryType FROM InjuryTypes</qstring>
  </query>
  <query name="BodyParts">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, BodyPart FROM BodyParts</qstring>
  </query>
  <query name="CurrentTools">
    <connection>Mattec</connection>
    <qstring>SELECT DISTINCT MoldIDs.MoldNo, MoldIDs.MoldID FROM vJobProd JOIN MoldIDs ON MoldIDs.MoldNo=vJobProd.MoldNo WHERE MachID=?</qstring>
  </query>
  <query name="Tools">
    <connection>Mattec</connection>
    <qstring>SELECT DISTINCT MoldNo, MoldID FROM MoldIDs</qstring>
  </query>
  <query name="RootCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT RCID, RootCause FROM vRootCause</qstring>
  </query>
  <query name="SecondaryCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT SRCID, SecondaryRootCause FROM vRootCause WHERE RCID=?</qstring>
  </query>
  <query name="MicroCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT MRCID, MicroRootCause FROM vRootCause WHERE RCID=? AND SRCID=?</qstring>
  </query>
  <query name="Actions">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ActionID, Action FROM vRootCause WHERE RCID=? AND SRCID=?</qstring>
  </query>
  <query name="EWORootCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT RCID, RootCause FROM vEWO_RootCause</qstring>
  </query>
  <query name="EWOSecondaryCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT SRCID, SecondaryRootCause FROM vEWO_RootCause WHERE RCID=?</qstring>
  </query>
  <query name="EWOActions">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ActionID, Action FROM vEWO_RootCause WHERE RCID=? AND SRCID=?</qstring>
  </query>
  <query name="CloseIssue">
    <connection>Safety</connection>
    <qstring>INSERT INTO ClosedIssues (FormName, FormNum, LineNum, ActionTaken) VALUES (?, ?, ?, ?)</qstring>
  </query>
  <query name="OpenIssue">
    <connection>Safety</connection>
    <qstring>DELETE FROM ClosedIssues WHERE FormName=? AND FormNum=? AND LineNum=?</qstring>
  </query>
  <query name="GetOpenIssues">
    <connection>Safety</connection>
    <qstring>SELECT * FROM OpenIssues</qstring>
  </query>
  <query name="GetClosedIssues">
    <connection>Safety</connection>
    <qstring>SELECT * FROM ClosedIssueDetails</qstring>
  </query>
  <query name="UATypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT UATID, UAType FROM vUATypes</qstring>
  </query>
  <query name="UAMicroTypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT UAMTID, UAMicroType FROM vUATypes WHERE UATID=?</qstring>
  </query>
  <query name="RepairTypes">
    <connection>Safety</connection>
    <qstring>SELECT ID, RepairType FROM RepairTypes</qstring>
  </query>
  <!-- Chart Queries -->
  <query name="MachMTBF">
    <connection>Safety</connection>
    <qstring>EXEC pMachMTBF @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MachMTTR">
    <connection>Safety</connection>
    <qstring>EXEC pMachMTTR @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MachDowntime">
    <connection>Safety</connection>
    <qstring>EXEC pMachDowntime @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MachScrap">
    <connection>Safety</connection>
    <qstring>EXEC pMachScrap @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MoldOEE">
    <connection>Safety</connection>
    <qstring>EXEC pAllMoldOEE @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MachOEE">
    <connection>Safety</connection>
    <qstring>EXEC pAllMachOEE @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="ToolMTBF">
    <connection>Safety</connection>
    <qstring>EXEC pMoldMTBF @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="PMDue">
    <connection>Safety</connection>
    <qstring>SELECT * FROM vNextPM</qstring>
  </query>
  <query name="AuditsPerAuditor">
    <connection>Safety</connection>
    <qstring>
      SELECT AuditorName, [WCC], [EHS] FROM 
      ( 
        SELECT AuditorName, AuditType
        FROM vAudits
      ) AS Temp
      PIVOT (
        COUNT(AuditType)
        FOR [AuditType] IN ([WCC], [EHS])
      ) AS Pivoted
    </qstring>
  </query>
  <query name="AuditsPerWorkCell">
    <connection>Safety</connection>
    <qstring>
      SELECT WorkCell, [WCC], [EHS] FROM 
      ( 
        SELECT WorkCell, AuditType
        FROM vAudits
      ) AS Temp
      PIVOT (
        COUNT(AuditType)
        FOR [AuditType] IN ([WCC], [EHS])
      ) AS Pivoted
    </qstring>
  </query>
  <query name="AuditsPerZone">
    <connection>Safety</connection>
    <qstring>
      SELECT Zone, [WCC], [EHS] FROM 
      ( 
        SELECT Zone, AuditType
        FROM vAudits
      ) AS Temp
      PIVOT (
        COUNT(AuditType)
        FOR [AuditType] IN ([WCC], [EHS])
      ) AS Pivoted
    </qstring>
  </query>
  <query name="AgingReport">
    <connection>Safety</connection>
    <qstring>SELECT Name + ' #' + CAST(ID  AS varchar(max)) + ' Line:' + CAST(LineNum AS varchar(max)) AS Issue, DaysOpen FROM OpenIssues WHERE DaysOpen>0 ORDER By DaysOpen</qstring>
  </query>
  <query name="SeverityReport">
    <connection>Safety</connection>
    <qstring>SELECT Severity, COUNT(*) AS [Open] FROM OpenIssues GROUP BY Severity</qstring>
  </query>
  <query name="IssuesBySeverity">
    <connection>Safety</connection>
    <qstring>SELECT Name + ' #' + CAST(ID  AS varchar(max)) + ' Line:' + CAST(LineNum AS varchar(max)) AS Issue, Severity FROM OpenIssues ORDER BY Severity</qstring>
  </query>
  <query name="ZonesNotAudited">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT Plant + ' ' + Department + ' ' + Zone FROM PLantLayout WHERE Plant + ' ' + Department + ' ' + Zone NOT IN (SELECT DISTINCT Plant + ' ' + Department + ' ' + Zone FROM vAudits)</qstring>
  </query>
  <query name="WorkCellsNotAudited">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT Plant + ' ' + Department + ' ' + WorkCell FROM PLantLayout WHERE Plant + ' ' + Department + ' ' + WorkCell NOT IN (SELECT DISTINCT Plant + ' ' + Department + ' ' + WorkCell FROM vAudits)</qstring>
  </query>
  <query name="AuditorsWithoutAudits">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT AuditorName, AuditorType FROM Auditor WHERE AuditorName NOT IN (SELECT DISTINCT AuditorName FROM vAudits)</qstring>
  </query>
  <query name="OilPerPress">
    <connection>Safety</connection>
    <qstring>SELECT Press, SUM(Qty) AS OilQty FROM ODL GROUP BY Press ORDER BY OilQty</qstring>
  </query>
  <query name="AllPlants">
    <connection>OpenCommercialIssues</connection>
    <qstring>SELECT * FROM Plants</qstring>
  </query>
  <query name="ProblemToolsRepairHistory">
    <connection>Safety</connection>
    <qstring>SELECT * FROM vProblemToolsRepairHistory</qstring>
  </query>
  <query name="ToolKeywordHistory">
    <connection>Safety</connection>
    <qstring>EXEC pToolKeywordsPeriodPivot @tools=?</qstring>
    <parameters>
      <parameter name="tools">
        <type>text</type>
      </parameter>
    </parameters>
  </query>
  <query name="KeywordsByTool">
    <connection>Safety</connection>
    <qstring>EXEC pKeywordsByTool</qstring>
    <parameters>
      <parameter name="userYear">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="KeywordsForTool">
    <connection>Safety</connection>
    <qstring>EXEC pKeywordsForTool @tools=?, @userYear=?</qstring>
    <parameters>
      <parameter name="tools">
        <type>text</type>
      </parameter>
      <parameter name="userYear">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="TagTrend">
    <connection>Safety</connection>
    <qstring>EXEC pTagTrend @userYear=?</qstring>
    <parameters>
      <parameter name="userYear">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="TagTrendMach">
    <connection>Safety</connection>
    <qstring>EXEC pTagTrendMach @userYear=?, @mach=?</qstring>
    <parameters>
      <parameter name="userYear">
        <type>number</type>
      </parameter>
      <parameter name="mach">
        <type>text</type>
      </parameter>
    </parameters>
  </query>
  <query name="PressStratification">
    <connection>Safety</connection>
    <qstring>EXEC pPressStratification @mach=?</qstring>
    <parameters>
      <parameter name="mach">
        <type>text</type>
      </parameter>
    </parameters>
  </query>
  <query name="EWOsVsBreakdowns">
    <connection>Safety</connection>
    <qstring>EXEC pEWOsVsBreakdowns @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="startDate">
        <type>date</type>
      </parameter>
      <parameter name="endDate">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="PMTagDetail">
    <connection>Safety</connection>
    <qstring>EXEC pPMTagDetail @mach=?, @year=?</qstring>
    <parameters>
      <parameter name="mach">
        <type>text</type>
      </parameter>
      <parameter name="year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="UCANDetail">
    <connection>Safety</connection>
    <qstring>EXEC pUCANDetail @mach=?, @year=?</qstring>
    <parameters>
      <parameter name="mach">
        <type>text</type>
      </parameter>
      <parameter name="year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="NumberOfIssuesByLine">
    <connection>Safety</connection>
    <qstring>
      SELECT (i.Name + ' - ' +
      al.Category + ' - ' +
      al.SubCategory) AS [Line Item],
      COUNT(*) AS Total
      FROM OpenIssues i
      JOIN vAuditLines al
      ON al.FormName=i.Name
      AND al.Line=i.LineNum
      GROUP BY i.Name, al.Category, al.SubCategory
    </qstring>
  </query>
  <query name="MachOEEByMonth">
    <connection>Safety</connection>
    <qstring>EXEC pMachOEEByMonth</qstring>
  </query>
</queries>