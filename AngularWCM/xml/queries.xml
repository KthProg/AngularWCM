<?xml version="1.0" encoding="utf-8" ?>
<queries>
  <query name="Plants">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT PlantID, Plant FROM vPlantLayout</qstring>
  </query>
  <query name="Departments">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT DepartmentID, Department FROM vPlantLayout WHERE PlantID=?</qstring>
  </query>
  <query name="Zones">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ZoneID, Zone FROM vPlantLayout WHERE PlantID=? AND DepartmentID=?</qstring>
  </query>
  <query name="WorkCells">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT WorkCellID, WorkCell FROM vPlantLayout WHERE PlantID=? AND DepartmentID=? AND ZoneID=?</qstring>
  </query>
  <query name="Machines">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT MachineID, Machine FROM vPlantLayout WHERE PlantID=? AND DepartmentID=? AND ZoneID=?</qstring>
  </query>
  <query name="Subsystems">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT PartID, Part FROM vPlantLayout WHERE PlantID=? AND DepartmentID=? AND ZoneID=? AND MachineID=?</qstring>
  </query>
  <query name="Auditors">
    <connection>Safety</connection>
    <qstring>
      SELECT au.ID, au.AuditorName
      FROM Auditor au
      JOIN Auditor_Types at
      ON at.AuditorID=au.ID
      WHERE at.AuditorType=?
    </qstring>
  </query>
  <query name="Supervisors">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, SupervisorName FROM Supervisor</qstring>
  </query>
  <query name="AccidentTypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, AccidentType FROM AccidentTypes</qstring>
  </query>
  <query name="InjuryTypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, InjuryType FROM InjuryTypes</qstring>
  </query>
  <query name="BodyParts">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ID, BodyPart FROM BodyParts</qstring>
  </query>
  <query name="CurrentTools">
    <connection>Mattec</connection>
    <qstring>SELECT DISTINCT MoldIDs.MoldNo, MoldIDs.MoldID FROM vJobProd JOIN MoldIDs ON MoldIDs.MoldNo=vJobProd.MoldNo WHERE MachID=?</qstring>
  </query>
  <query name="Tools">
    <connection>Mattec</connection>
    <qstring>SELECT DISTINCT MoldNo, MoldID FROM MoldIDs</qstring>
  </query>
  <query name="RootCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT RCID, RootCause FROM vRootCause</qstring>
  </query>
  <query name="SecondaryCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT SRCID, SecondaryRootCause FROM vRootCause WHERE RCID=?</qstring>
  </query>
  <query name="MicroCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT MRCID, MicroRootCause FROM vRootCause WHERE RCID=? AND SRCID=?</qstring>
  </query>
  <query name="Actions">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ActionID, Action FROM vRootCause WHERE RCID=? AND SRCID=?</qstring>
  </query>
  <query name="EWORootCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT RCID, RootCause FROM vEWO_RootCause</qstring>
  </query>
  <query name="EWOSecondaryCauses">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT SRCID, SecondaryRootCause FROM vEWO_RootCause WHERE RCID=?</qstring>
  </query>
  <query name="EWOActions">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ActionID, Action FROM vEWO_RootCause WHERE RCID=? AND SRCID=?</qstring>
  </query>
  <query name="CloseIssue">
    <connection>Safety</connection>
    <qstring>INSERT INTO ClosedIssues (FormName, FormNum, LineNum, ActionTaken) VALUES (?, ?, ?, ?)</qstring>
  </query>
  <query name="OpenIssue">
    <connection>Safety</connection>
    <qstring>DELETE FROM ClosedIssues WHERE FormName=? AND FormNum=? AND LineNum=?</qstring>
  </query>
  <query name="GetOpenIssues">
    <connection>Safety</connection>
    <qstring>SELECT * FROM vOpenIssues</qstring>
  </query>
  <query name="GetClosedIssues">
    <connection>Safety</connection>
    <qstring>SELECT * FROM vClosedIssues</qstring>
  </query>
  <query name="UATypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT UATID, UAType FROM vUATypes</qstring>
  </query>
  <query name="UAMicroTypes">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT UAMTID, UAMicroType FROM vUATypes WHERE UATID=?</qstring>
  </query>
  <query name="RepairTypes">
    <connection>Safety</connection>
    <qstring>SELECT ID, RepairType FROM RepairTypes</qstring>
  </query>
  <query name="SupervisorEmailsByLocation">
    <connection>Safety</connection>
    <qstring>SELECT ID, SupervisorEmail FROM Supervisor WHERE PlantID=? AND (DepartmentID=? OR DepartmentID IS NULL) AND (ZoneID=? OR ZoneID IS NULL) </qstring>
  </query>
  <query name="AuditLines">
    <connection>Safety</connection>
    <qstring>SELECT Category, SubCategory, Details FROM vAuditLines WHERE FormName=? ORDER BY Line</qstring>
  </query>
  <query name="AllMachinesMattec">
    <connection>Mattec</connection>
    <qstring>SELECT MachNo, MachID FROM MachCon</qstring>
  </query>
  <query name="AllMachines">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT MachineID, Plant + ' - ' + Department + ' - ' + Zone + ' - ' + Machine FROM vPlantLayout</qstring>
  </query>
  <query name="AllZones">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT ZoneID, Plant + ' - ' + Department + ' - ' + Zone FROM vPlantLayout</qstring>
  </query>
  <query name="AllDepartments">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT DepartmentID, Plant + ' - ' + Department FROM vPlantLayout</qstring>
  </query>
  <query name="AllToolsText">
    <connection>Mattec</connection>
    <qstring>SELECT DISTINCT MoldID, MoldID FROM MoldIDs</qstring>
  </query>
  <query name="GetToolDesc">
    <connection>Mattec</connection>
    <qstring>SELECT TOP 1 0, MoldDesc FROM MoldIDs WHERE MoldID=?</qstring>
  </query>
  <query name="GetDashboardLayouts">
    <connection>Safety</connection>
    <qstring>SELECT ID, Name FROM ReportingLayouts</qstring>
  </query>
  <query name="OpenDashboardLayout">
    <connection>Safety</connection>
    <qstring>SELECT LayoutJSON FROM ReportingLayouts WHERE ID=?</qstring>
  </query>
  <query name="SaveDashboardLayout">
    <connection>Safety</connection>
    <qstring>INSERT INTO ReportingLayouts (LayoutJSON, Name) VALUES(?, ?)</qstring>
  </query>
  <query name="UpdateDashboardLayout">
    <connection>Safety</connection>
    <qstring>UPDATE ReportingLayouts SET LayoutJSON=? WHERE ID=?</qstring>
  </query>
  <query name="SearchForm">
    <connection>Safety</connection>
    <qstring>
      EXEC('
      SELECT ROW_NUMBER() OVER(ORDER BY (select 0)) AS RowNum, 
        ' + ? + '
      FROM ' + ? + '
      WHERE CAST(' + ? + ' as varchar(max))
        LIKE ''%' + ? + '%''')
    </qstring>
  </query>
  <!-- Chart Queries -->
  <query name="MachMTBF">
    <connection>Safety</connection>
    <qstring>EXEC pMachMTBF @startDate=?, @endDate=?, @failureType=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
      <parameter name="Failure Type">
        <type>select</type>
        <options>
          <option value="major">major</option>
          <option value="minor">minor</option>
        </options>
      </parameter>
    </parameters>
  </query>
  <query name="MachMTTR">
    <connection>Safety</connection>
    <qstring>EXEC pMachMTTR @startDate=?, @endDate=?, @failureType=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
      <parameter name="Failure Type">
        <type>select</type>
        <options>
          <option value="major">major</option>
          <option value="minor">minor</option>
        </options>
      </parameter>
    </parameters>
  </query>
  <query name="MachDowntime">
    <connection>Safety</connection>
    <qstring>EXEC pMachDowntime @startDate=?, @endDate=?, @failureType=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
      <parameter name="Failure Type">
        <type>select</type>
        <options>
          <option value="major">major</option>
          <option value="minor">minor</option>
        </options>
      </parameter>
    </parameters>
  </query>
  <query name="MaintDowntime">
    <connection>Safety</connection>
    <qstring>EXEC pMaintDowntime @startDate=?, @endDate=?, @failureType=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
      <parameter name="Failure Type">
        <type>select</type>
        <options>
          <option value="major">major</option>
          <option value="minor">minor</option>
        </options>
      </parameter>
    </parameters>
  </query>
  <query name="MachScrap">
    <connection>Safety</connection>
    <qstring>EXEC pMachScrap @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MoldOEE">
    <connection>Safety</connection>
    <qstring>EXEC pAllMoldOEE @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="MachOEE">
    <connection>Safety</connection>
    <qstring>EXEC pAllMachOEE @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="ToolMTBF">
    <connection>Safety</connection>
    <qstring>EXEC pMoldMTBF @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="PMDue">
    <connection>Safety</connection>
    <qstring>SELECT * FROM vNextPM</qstring>
  </query>
  <query name="WCCPerAuditor">
    <connection>Safety</connection>
    <qstring>SELECT AuditorName, COUNT(*) AS Audits FROM vWCC GROUP BY AuditorName</qstring>
  </query>
  <query name="EHSPerAuditor">
    <connection>Safety</connection>
    <qstring>SELECT AuditorName, COUNT(*) AS Audits FROM vEHS GROUP BY AuditorName</qstring>
  </query>
  <query name="WCCPerWorkCell">
    <connection>Safety</connection>
    <qstring>SELECT Department + ' - ' + WorkCell AS WorkCell, COUNT(*) AS Audits FROM vWCC GROUP BY Department + ' - ' + WorkCell</qstring>
  </query>
  <query name="EHSPerWorkCell">
    <connection>Safety</connection>
    <qstring>SELECT Department + ' - ' + WorkCell AS WorkCell, COUNT(*) AS Audits FROM vEHS GROUP BY Department + ' - ' + WorkCell</qstring>
  </query>
  <query name="WCCPerZone">
    <connection>Safety</connection>
    <qstring>SELECT Department + ' - ' + Zone AS DeptZone, COUNT(*) AS Audits FROM vWCC GROUP BY Department + ' - ' + Zone</qstring>
  </query>
  <query name="EHSPerZone">
    <connection>Safety</connection>
    <qstring>SELECT Department + ' - ' + Zone AS DeptZone, COUNT(*) AS Audits FROM vEHS GROUP BY Department + ' - ' + Zone</qstring>
  </query>
  <query name="AgingReport">
    <connection>Safety</connection>
    <qstring>SELECT Name + ' #' + CAST(ID  AS varchar(max)) + ' Line:' + CAST(LineNum AS varchar(max)) AS Issue, DaysOpen FROM vOpenIssues WHERE DaysOpen>0 ORDER By DaysOpen</qstring>
  </query>
  <query name="SeverityReport">
    <connection>Safety</connection>
    <qstring>SELECT Severity, COUNT(*) AS [Open] FROM vOpenIssues GROUP BY Severity</qstring>
  </query>
  <query name="IssuesBySeverity">
    <connection>Safety</connection>
    <qstring>SELECT Name + ' #' + CAST(ID  AS varchar(max)) + ' Line:' + CAST(LineNum AS varchar(max)) AS Issue, Severity FROM vOpenIssues ORDER BY Severity</qstring>
  </query>
  <query name="ZonesNotEHSd">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT Plant + ' ' + Department + ' ' + Zone AS Zone FROM vPlantLayout WHERE Plant + ' ' + Department + ' ' + Zone NOT IN (SELECT DISTINCT Plant + ' ' + Department + ' ' + Zone FROM vEHS WHERE Plant + ' ' + Department + ' ' + Zone IS NOT NULL)</qstring>
  </query>
  <query name="ZonesNotWCCd">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT Plant + ' ' + Department + ' ' + Zone AS Zone FROM vPlantLayout WHERE Plant + ' ' + Department + ' ' + Zone NOT IN (SELECT DISTINCT Plant + ' ' + Department + ' ' + Zone FROM vWCC WHERE Plant + ' ' + Department + ' ' + Zone IS NOT NULL)</qstring>
  </query>
  <query name="WorkCellsNotEHSd">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT Plant + ' ' + Department + ' ' + WorkCell AS WorkCell FROM vPlantLayout WHERE Plant + ' ' + Department + ' ' + WorkCell NOT IN (SELECT DISTINCT Plant + ' ' + Department + ' ' + WorkCell FROM vEHS WHERE Plant + ' ' + Department + ' ' + WorkCell IS NOT NULL)</qstring>
  </query>
  <query name="WorkCellsNotWCCd">
    <connection>Safety</connection>
    <qstring>SELECT DISTINCT Plant + ' ' + Department + ' ' + WorkCell AS WorkCell FROM vPlantLayout WHERE Plant + ' ' + Department + ' ' + WorkCell NOT IN (SELECT DISTINCT Plant + ' ' + Department + ' ' + WorkCell FROM vWCC WHERE Plant + ' ' + Department + ' ' + WorkCell IS NOT NULL)</qstring>
  </query>
  <query name="AuditorsWithoutWCCs">
    <connection>Safety</connection>
    <qstring>
      SELECT DISTINCT AuditorName, AuditorType
      FROM Auditor au
      JOIN Auditor_Types at
      ON at.AuditorID=au.ID
      WHERE AuditorName NOT IN (SELECT DISTINCT AuditorName FROM vWCC WHERE AuditorName IS NOT NULL)
        AND AuditorType='WCC'
    </qstring>
  </query>
  <query name="AuditorsWithoutEHSs">
    <connection>Safety</connection>
    <qstring>
      SELECT DISTINCT AuditorName, AuditorType
      FROM Auditor au
      JOIN Auditor_Types at
      ON at.AuditorID=au.ID
      WHERE AuditorName NOT IN (SELECT DISTINCT AuditorName FROM vEHS WHERE AuditorName IS NOT NULL)
        AND AuditorType='EHS'
    </qstring>
  </query>
  <query name="OilPerPress">
    <connection>Safety</connection>
    <qstring>EXEC pOilUsage @start=?, @end=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="TagTrend">
    <connection>Safety</connection>
    <qstring>EXEC pTagTrend @userYear=?</qstring>
    <parameters>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="TagTrendMach">
    <connection>Safety</connection>
    <qstring>EXEC pTagTrendMach @userYear=?, @mach=?</qstring>
    <parameters>
      <parameter name="Year">
        <type>number</type>
      </parameter>
      <parameter name="Machine">
        <type>select</type>
        <query>AllMachines</query>
      </parameter>
    </parameters>
  </query>
  <query name="PressStratification">
    <connection>Safety</connection>
    <qstring>EXEC pPressStratification</qstring>
  </query>
  <query name="EWOsVsBreakdowns">
    <connection>Safety</connection>
    <qstring>EXEC pEWOsVsBreakdowns @startDate=?, @endDate=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
    </parameters>
  </query>
  <query name="PMTagDetail">
    <connection>Safety</connection>
    <qstring>EXEC pPMTagDetail @mach=?, @year=?</qstring>
    <parameters>
      <parameter name="Machine">
        <type>select</type>
        <query>AllMachines</query>
      </parameter>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="UCANDetail">
    <connection>Safety</connection>
    <qstring>EXEC pUCANDetail @mach=?, @year=?</qstring>
    <parameters>
      <parameter name="Machine">
        <type>select</type>
        <query>AllMachines</query>
      </parameter>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="NumberOfIssuesByLine">
    <connection>Safety</connection>
    <qstring>
      SELECT al.SubCategory AS [Line Item],
      COUNT(*) AS Total
      FROM vOpenIssues i
      JOIN vAuditLines al
      ON al.FormName=i.Name
      AND al.Line=i.LineNum
      GROUP BY al.SubCategory
    </qstring>
  </query>
  <query name="MachOEEByMonth">
    <connection>Safety</connection>
    <qstring>EXEC pMachOEEByMonth @year=?</qstring>
    <parameters>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="MachDownCodesByMonth">
    <connection>Safety</connection>
    <qstring>EXEC pMachDownTimeByMonth @startDate=?, @endDate=?, @machine=?, @failureType=?</qstring>
    <parameters>
      <parameter name="Start Date">
        <type>date</type>
      </parameter>
      <parameter name="End Date">
        <type>date</type>
      </parameter>
      <parameter name="Machine">
        <type>select</type>
        <query>AllMachinesMattec</query>
      </parameter>
      <parameter name="Failure Type">
        <type>select</type>
        <options>
          <option value="major">major</option>
          <option value="minor">minor</option>
        </options>
      </parameter>
    </parameters>
  </query>
  <query name="5TScoreByMachine">
    <connection>Safety</connection>
    <qstring>EXEC pFiveTScoreByMachinePerMonth @machine=?, @year=?</qstring>
    <parameters>
      <parameter name="Machine">
        <type>select</type>
        <query>AllMachines</query>
      </parameter>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="5TScoreByZone">
    <connection>Safety</connection>
    <qstring>EXEC pFiveTScoreByZonePerMonth @zone=?, @year=?</qstring>
    <parameters>
      <parameter name="Zone">
        <type>select</type>
        <query>AllZones</query>
      </parameter>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="5TScoreByDept">
    <connection>Safety</connection>
    <qstring>EXEC pFiveTScoreByDeptPerMonth @dept=?, @year=?</qstring>
    <parameters>
      <parameter name="Department">
        <type>select</type>
        <query>AllDepartments</query>
      </parameter>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
  <query name="5TAuditScores">
    <connection>Safety</connection>
    <qstring>SELECT ID, AuditDate, Plant, Department, Zone, Machine, [Total Score], [Total Possible] FROM vFiveT WHERE YEAR(AuditDate)=?</qstring>
    <parameters>
      <parameter name="Year">
        <type>number</type>
      </parameter>
    </parameters>
  </query>
<query name="LPAAuditsByAuditor">
  <connection>Safety</connection>
  <qstring>
    SELECT AuditorName, COUNT(*) AS Audits
    FROM vLPA
    GROUP BY AuditorName
  </qstring>
</query>
</queries>